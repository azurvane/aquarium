#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>

#define SCREEN_I2C_ADDR 0x3C // or 0x3C
#define SCREEN_WIDTH 128     // OLED display width, in pixels
#define SCREEN_HEIGHT 64     // OLED display height, in pixels
#define OLED_RST_PIN -1      // Reset pin (-1 if not available)

Adafruit_SSD1306 display(128, 64, &Wire, OLED_RST_PIN);

int frame_fish = 0;
int frame_seaweed = 0;
int start_x = 0;
int start_y = 8;
int speed = 2;
int direction = 1; // 1 = moving right, -1 = moving left
int radius = 2;
bool bubble_appear = false;
int bubble_x = start_x;
int bubble_y_start = 20;
int bubble_y = bubble_y_start;
int offset = 7;

#define FRAME_DELAY (42)
#define FRAME_WIDTH_N (48)
#define FRAME_HEIGHT_N (48)
#define FRAME_COUNT_FISH (sizeof(fish_frames) / sizeof(fish_frames[0]))

const unsigned char PROGMEM fish_frames[][288] = {
		// 'frame1, 48x48px
	{	
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x00, 
	0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, 0x00, 0x00, 
	0x00, 0x00, 0x03, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x33, 0x01, 0x80, 0x00, 0x00, 0x00, 0x7c, 0x00, 
	0xc0, 0x00, 0x00, 0x00, 0x78, 0x00, 0xa0, 0x00, 0x00, 0x00, 0x30, 0x00, 0x90, 0x00, 0x00, 0x7e, 
	0x60, 0x00, 0x18, 0x00, 0x00, 0xff, 0xc0, 0x00, 0x08, 0x00, 0x00, 0xff, 0xc0, 0x00, 0x04, 0x00, 
	0x00, 0x00, 0xe0, 0x00, 0x04, 0x00, 0x00, 0x00, 0x30, 0x00, 0x08, 0x00, 0x00, 0x00, 0x78, 0x00, 
	0x08, 0x00, 0x00, 0x00, 0x7c, 0x00, 0x90, 0x00, 0x00, 0x00, 0x3e, 0x00, 0xa0, 0x00, 0x00, 0x00, 
	0x39, 0x80, 0xc0, 0x00, 0x00, 0x00, 0x30, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00, 0xbc, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  },
	
	// 'frame2, 48x48px
  {	
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x38, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x3c, 
	0x01, 0xe0, 0x00, 0x00, 0x00, 0x1c, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x1c, 0x03, 0xf8, 0x00, 0x00, 
	0x00, 0x1c, 0x03, 0xfe, 0x00, 0x00, 0x00, 0x1c, 0x33, 0x01, 0x80, 0x00, 0x00, 0x0c, 0x7c, 0x00, 
	0xc0, 0x00, 0x00, 0x0e, 0x78, 0x00, 0xa0, 0x00, 0x00, 0x07, 0xf0, 0x00, 0x90, 0x00, 0x00, 0x06, 
	0xc0, 0x00, 0x18, 0x00, 0x00, 0x03, 0x00, 0x00, 0x08, 0x00, 0x00, 0x01, 0x80, 0x00, 0x04, 0x00, 
	0x00, 0x00, 0x60, 0x00, 0x04, 0x00, 0x00, 0x00, 0x30, 0x00, 0x08, 0x00, 0x00, 0x00, 0x78, 0x00, 
	0x08, 0x00, 0x00, 0x00, 0x7c, 0x00, 0x90, 0x00, 0x00, 0x00, 0x3e, 0x00, 0xa0, 0x00, 0x00, 0x00, 
	0x39, 0x80, 0xc0, 0x00, 0x00, 0x00, 0x30, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00, 0xbc, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  },
	
	// 'frame3, 48x48px
  {	
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x00, 
	0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x60, 0x03, 0xf8, 0x00, 0x00, 
	0x00, 0x58, 0x03, 0xfe, 0x00, 0x00, 0x00, 0x78, 0x33, 0x01, 0x80, 0x00, 0x00, 0x7c, 0x7c, 0x00, 
	0xc0, 0x00, 0x00, 0x3e, 0x78, 0x00, 0xa0, 0x00, 0x00, 0x3f, 0xf0, 0x00, 0x90, 0x00, 0x00, 0x1e, 
	0xc0, 0x00, 0x08, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x08, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x04, 0x00, 
	0x00, 0x3f, 0xc0, 0x00, 0x04, 0x00, 0x00, 0x3f, 0xe0, 0x00, 0x08, 0x00, 0x00, 0x7c, 0x78, 0x00, 
	0x08, 0x00, 0x00, 0x78, 0x7c, 0x00, 0x90, 0x00, 0x00, 0x78, 0x3e, 0x00, 0xa0, 0x00, 0x00, 0x60, 
	0x39, 0x80, 0xc0, 0x00, 0x00, 0x00, 0x30, 0xff, 0x80, 0x00, 0x00, 0x00, 0x00, 0xbc, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xe0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  },
	
	// 'frame4, 48x48px
  {	
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x00, 0x00, 0x00, 0x00, 
	0x01, 0xe0, 0x00, 0x00, 0x00, 0x00, 0x01, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x03, 0xf8, 0x00, 0x00, 
	0x00, 0x00, 0x03, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x33, 0x01, 0x80, 0x00, 0x00, 0x00, 0x7c, 0x00, 
	0xc0, 0x00, 0x00, 0x04, 0x78, 0x00, 0xa0, 0x00, 0x00, 0x0f, 0xf0, 0x00, 0x90, 0x00, 0x00, 0x1e, 
	0xc0, 0x00, 0x18, 0x00, 0x00, 0x1e, 0x00, 0x00, 0x08, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x04, 0x00, 
	0x00, 0x3f, 0xc0, 0x00, 0x04, 0x00, 0x00, 0x3f, 0xe0, 0x00, 0x08, 0x00, 0x00, 0x1c, 0x78, 0x00, 
	0x08, 0x00, 0x00, 0x38, 0x7c, 0x00, 0x90, 0x00, 0x00, 0x38, 0x3e, 0x00, 0xa0, 0x00, 0x00, 0x38, 
	0x39, 0x80, 0xc0, 0x00, 0x00, 0x30, 0x30, 0xff, 0x80, 0x00, 0x00, 0x38, 0x00, 0xbc, 0x00, 0x00, 
	0x00, 0x38, 0x00, 0xf0, 0x00, 0x00, 0x00, 0x38, 0x00, 0xe0, 0x00, 0x00, 0x00, 0x38, 0x00, 0xe0, 
	0x00, 0x00, 0x00, 0x18, 0x00, 0xc0, 0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
  }
};


#define FRAME_COUNT_SEAWEED (sizeof(seaweed1) / sizeof(seaweed1[0]))

const unsigned char PROGMEM seaweed1[][288] = {
	// 'frame1, 48x48px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x20, 0x00, 0x00, 0x00, 0x00, 0x70, 0x28, 0x00, 0x00, 
	0x00, 0x00, 0xb4, 0x38, 0x00, 0x00, 0x00, 0x00, 0xfc, 0xde, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x7e, 
	0x00, 0x00, 0x00, 0x00, 0x78, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x74, 0x7c, 0x00, 0x00, 0x00, 0x01, 
	0xec, 0xbb, 0x00, 0x00, 0x00, 0x01, 0xfc, 0xb7, 0x00, 0x00, 0x00, 0x00, 0xf0, 0xf6, 0x00, 0x00, 
	0x00, 0x00, 0x78, 0x7c, 0x00, 0x00, 0x00, 0x00, 0xba, 0x3c, 0x80, 0x00, 0x00, 0x00, 0xf6, 0xd8, 
	0x80, 0x00, 0x00, 0x00, 0xf4, 0xe9, 0x80, 0x00, 0x00, 0x00, 0x74, 0x3f, 0x00, 0x00, 0x00, 0x01, 
	0x34, 0x3f, 0x00, 0x00, 0x00, 0x01, 0x9c, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x98, 0xe4, 0x40, 0x00, 
	0x00, 0x00, 0xf0, 0xbd, 0x80, 0x00, 0x00, 0x00, 0x72, 0xdd, 0x80, 0x00, 0x00, 0x00, 0x36, 0xe7, 
	0x00, 0x00, 0x00, 0x00, 0x3e, 0x67, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x3e, 0x00, 0x00, 0x00, 0x01, 
	0x34, 0x9c, 0x00, 0x00, 0x00, 0x01, 0xfc, 0x9d, 0x80, 0x00, 0x00, 0x01, 0xfc, 0xdb, 0x80, 0x00, 
	0x00, 0x00, 0x78, 0x7f, 0x00, 0x00, 0x00, 0x00, 0xbb, 0xff, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 
	0x00, 0x00, 0x00, 0x00, 0x7e, 0xfc, 0x00, 0x00, 0x00, 0x00, 0xbc, 0x78, 0x00, 0x00, 0x00, 0x00, 
	0xf8, 0x78, 0x00, 0x00, 0x00, 0x00, 0x68, 0x18, 0x00, 0x00, 0x00, 0x00, 0x08, 0x18, 0x00, 0x00, 
	0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	},

	// 'frame2, 48x48px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x28, 0x00, 0x00, 
	0x00, 0x00, 0xd0, 0x38, 0x00, 0x00, 0x00, 0x01, 0x70, 0xdc, 0x00, 0x00, 0x00, 0x01, 0xf0, 0x7c, 
	0x00, 0x00, 0x00, 0x01, 0xe0, 0x7c, 0x00, 0x00, 0x00, 0x00, 0xc8, 0x7c, 0x00, 0x00, 0x00, 0x00, 
	0x58, 0xbe, 0x00, 0x00, 0x00, 0x01, 0xf8, 0xb7, 0x00, 0x00, 0x00, 0x00, 0xf8, 0xf5, 0x00, 0x00, 
	0x00, 0x00, 0xf8, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x3d, 0x00, 0x00, 0x00, 0x00, 0xb4, 0xd9, 
	0x00, 0x00, 0x00, 0x00, 0xf4, 0x69, 0x00, 0x00, 0x00, 0x01, 0x74, 0x7f, 0x00, 0x00, 0x00, 0x01, 
	0xf4, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x9c, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x98, 0x74, 0x40, 0x00, 
	0x00, 0x00, 0xf2, 0xbd, 0xc0, 0x00, 0x00, 0x00, 0x72, 0xdd, 0x80, 0x00, 0x00, 0x00, 0x3e, 0xe7, 
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x67, 0x00, 0x00, 0x00, 0x01, 0x38, 0x3e, 0x00, 0x00, 0x00, 0x01, 
	0x30, 0x9d, 0x80, 0x00, 0x00, 0x01, 0xfc, 0x9d, 0x80, 0x00, 0x00, 0x01, 0xfc, 0xdb, 0x00, 0x00, 
	0x00, 0x00, 0x7a, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x3a, 0x7e, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 
	0x00, 0x00, 0x00, 0x00, 0xfe, 0x5e, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x78, 0x00, 0x00, 0x00, 0x00, 
	0x78, 0x78, 0x00, 0x00, 0x00, 0x00, 0x68, 0x18, 0x00, 0x00, 0x00, 0x00, 0x08, 0x18, 0x00, 0x00, 
	0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	},
	
	// 'frame3, 48x48px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x01, 0xc0, 0x40, 0x00, 0x00, 
	0x00, 0x01, 0xf0, 0x78, 0x00, 0x00, 0x00, 0x02, 0xf0, 0xb8, 0x00, 0x00, 0x00, 0x03, 0xe0, 0xd8, 
	0x00, 0x00, 0x00, 0x01, 0xe8, 0x58, 0x00, 0x00, 0x00, 0x00, 0xc8, 0x78, 0x00, 0x00, 0x00, 0x00, 
	0x58, 0x7e, 0x00, 0x00, 0x00, 0x01, 0xf0, 0xb7, 0x00, 0x00, 0x00, 0x01, 0xf8, 0xf4, 0x00, 0x00, 
	0x00, 0x00, 0xf8, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x7e, 0x3d, 0x00, 0x00, 0x00, 0x00, 0xb4, 0xd9, 
	0x00, 0x00, 0x00, 0x00, 0xf4, 0x6d, 0x00, 0x00, 0x00, 0x01, 0x74, 0x7f, 0x00, 0x00, 0x00, 0x01, 
	0xf4, 0x3f, 0x00, 0x00, 0x00, 0x00, 0x9c, 0x1e, 0x00, 0x00, 0x00, 0x00, 0x98, 0x64, 0x40, 0x00, 
	0x00, 0x00, 0xf2, 0xbd, 0xc0, 0x00, 0x00, 0x00, 0x72, 0xdd, 0x80, 0x00, 0x00, 0x00, 0x3e, 0xe7, 
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x67, 0x00, 0x00, 0x00, 0x01, 0x38, 0x3e, 0x00, 0x00, 0x00, 0x01, 
	0x30, 0x9d, 0x80, 0x00, 0x00, 0x01, 0xfc, 0x9d, 0x00, 0x00, 0x00, 0x01, 0xfc, 0xdb, 0x00, 0x00, 
	0x00, 0x00, 0x7a, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x3a, 0x7e, 0x00, 0x00, 0x00, 0x00, 0xfe, 0xff, 
	0x00, 0x00, 0x00, 0x00, 0xfe, 0xdf, 0x00, 0x00, 0x00, 0x00, 0x3c, 0x78, 0x00, 0x00, 0x00, 0x00, 
	0x78, 0x78, 0x00, 0x00, 0x00, 0x00, 0x28, 0x18, 0x00, 0x00, 0x00, 0x00, 0x08, 0x18, 0x00, 0x00, 
	0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	}
};

#define FRAME_WIDTH_S (24)
#define FRAME_HEIGHT_S (24)

const unsigned char PROGMEM seaweed2[][288] = {
	// 'frame1, 24x24px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x44, 0x00, 0x00, 0xe6, 0x00, 0x00, 
	0xee, 0x00, 0x00, 0xe7, 0x00, 0x00, 0xef, 0x00, 0x00, 0xe6, 0x00, 0x00, 0xfe, 0x00, 0x01, 0xe7, 
	0x00, 0x00, 0xe6, 0x00, 0x00, 0xcf, 0x80, 0x00, 0x7f, 0x00, 0x01, 0x6e, 0x80, 0x01, 0xef, 0x80, 
	0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00, 0xec, 0x00, 0x00, 0x24, 0x00, 0x00, 0x26, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	},

	// 'frame2, 24x24px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x84, 0x00, 0x01, 0xc6, 0x00, 0x01, 
	0xce, 0x00, 0x00, 0xa6, 0x00, 0x01, 0xcf, 0x00, 0x00, 0xee, 0x00, 0x00, 0xef, 0x00, 0x01, 0xe7, 
	0x00, 0x00, 0xe6, 0x00, 0x00, 0xdf, 0x80, 0x00, 0x6f, 0x00, 0x01, 0x66, 0x00, 0x01, 0xef, 0x00, 
	0x00, 0x7f, 0x00, 0x00, 0xff, 0x00, 0x00, 0xec, 0x00, 0x00, 0x24, 0x00, 0x00, 0x26, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	},

	// 'frame3, 24x24px
	{
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x88, 0x00, 0x01, 0xce, 0x00, 0x01, 
	0xce, 0x00, 0x00, 0x8e, 0x00, 0x01, 0xcf, 0x00, 0x00, 0xee, 0x00, 0x00, 0xef, 0x00, 0x01, 0xe7, 
	0x00, 0x00, 0xe6, 0x00, 0x00, 0xdf, 0x80, 0x00, 0x6f, 0x00, 0x01, 0x66, 0x00, 0x01, 0xef, 0x00, 
	0x00, 0x7f, 0x00, 0x00, 0xff, 0x00, 0x00, 0xec, 0x00, 0x00, 0x24, 0x00, 0x00, 0x26, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	}
};





void setup() {
  display.begin(SSD1306_SWITCHCAPVCC, SCREEN_I2C_ADDR);
}



// Helper function to draw the bitmap flipped horizontally
void drawBitmapFlipped(int16_t x, int16_t y, const uint8_t bitmap[], int16_t w, int16_t h, uint16_t color) {
  for (int16_t j = 0; j < h; j++) {
    for (int16_t i = 0; i < w; i++) {
      // Read the bit from the original bitmap
      if (pgm_read_byte(&bitmap[j * ((w + 7) / 8) + i / 8]) & (128 >> (i & 7))) {
        // Draw the pixel at the "mirrored" X position
        display.drawPixel(x + w - 1 - i, y + j, color);
      }
    }
  }
}

void drawBubbles(int trigger, int offset, int16_t x, uint16_t color) {
  if (trigger == 10 && bubble_appear == false) {
    bubble_appear = true;
		bubble_x = x;
  }

	if (bubble_appear == true) {
		display.drawCircle(bubble_x, bubble_y, radius, color);
		display.drawCircle(bubble_x + offset, bubble_y + abs(offset), radius, color);
		display.drawCircle(bubble_x, bubble_y + (abs(offset) * 2), radius, color);
		bubble_y -= (abs(direction) * speed);
	}

	if (bubble_y + (abs(offset) * 2) < -radius) {
		bubble_y = bubble_y_start;
		bubble_appear = false;
	}
}

void loop() {
  display.clearDisplay();
  int trigger = random(0, 100);

  // 1. Draw the character based on direction
  // for reverse direction the starting point is perfect
  // for forwar direction starting point + 45 is perfect
  if (direction == 1) {
    // Normal walk (facing right)
    display.drawBitmap(start_x, start_y, fish_frames[frame_fish], FRAME_WIDTH_N, FRAME_HEIGHT_N, 1);
    drawBubbles(trigger, offset, start_x + 45, 1);
  } else {
    // Flipped walk (facing left)
    drawBitmapFlipped(start_x, start_y, fish_frames[frame_fish], FRAME_WIDTH_N, FRAME_HEIGHT_N, 1);
    drawBubbles(trigger, (offset * -1), start_x, 1);
  }

	display.drawBitmap(10, 32, seaweed1[frame_seaweed], FRAME_WIDTH_N, FRAME_HEIGHT_N, 1);
	display.drawBitmap(80, 43, seaweed2[frame_seaweed], FRAME_WIDTH_S, FRAME_HEIGHT_S, 1);
  display.display();

  // 2. Update animation frame
  frame_fish = (frame_fish + 1) % FRAME_COUNT_FISH;
	frame_seaweed = (frame_seaweed + 1) % FRAME_COUNT_SEAWEED;

  // 3. Update position
  start_x += (direction * speed); 

  // 4. Collision Detection (The "Bounce")
  if (start_x >= (SCREEN_WIDTH - FRAME_WIDTH_N)) {
    direction = -1; // Hit right wall, turn left
  } 
  else if (start_x <= 0) {
    direction = 1;  // Hit left wall, turn right
  }

  delay(FRAME_DELAY);
}